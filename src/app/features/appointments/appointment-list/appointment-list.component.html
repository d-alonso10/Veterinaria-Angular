<div class="main-content">
    <div class="header-actions" style="margin-bottom: 20px; justify-content: space-between; display: flex;">
        <h2>Listado de Citas</h2>
        <a routerLink="/appointments/new" class="btn btn-primary">âž• Nueva Cita</a>
    </div>

    <div class="card" style="background: white; padding: 20px; border-radius: 16px; box-shadow: 0 8px 32px rgba(0,0,0,0.1);">
        <table style="width: 100%; border-collapse: collapse;">
            <thead>
                <tr style="text-align: left; border-bottom: 2px solid #f0f0f0;">
                    <th style="padding: 12px;">Fecha</th>
                    <th style="padding: 12px;">Cliente</th>
                    <th style="padding: 12px;">Mascota</th>
                    <th style="padding: 12px;">Servicio</th>
                    <th style="padding: 12px;">Modalidad</th>
                    <th style="padding: 12px;">Estado</th>
                    <th style="padding: 12px;">Acciones</th>
                </tr>
            </thead>
            <tbody>
                @for (cita of citas; track cita.idCita) {
                    <tr style="border-bottom: 1px solid #f0f0f0;">
                        <td style="padding: 12px;">{{ cita.fechaProgramada | date:'medium' }}</td>
                        <td style="padding: 12px;">{{ cita.nombreCliente || 'Cliente #' + cita.idCliente }}</td>
                        <td style="padding: 12px;">{{ cita.nombreMascota || 'Mascota #' + cita.idMascota }}</td>
                        <td style="padding: 12px;">{{ cita.nombreServicio || 'Servicio #' + cita.idServicio }}</td>
                        <td style="padding: 12px;">{{ cita.modalidad }}</td>
                        <td style="padding: 12px;">
                            <span [ngClass]="{
                                'badge-success': cita.estado === 'confirmada',
                                'badge-warning': cita.estado === 'reservada',
                                'badge-danger': cita.estado === 'cancelada'
                            }" style="padding: 4px 8px; border-radius: 4px; font-size: 0.9em;">
                                {{ cita.estado }}
                            </span>
                        </td>
                        <td style="padding: 12px;">
                            @if (cita.estado === 'reservada') {
                                <button (click)="confirmCita(cita.idCita!)" class="btn btn-success btn-small" style="margin-right: 5px;">Confirmar</button>
                            }
                            @if (cita.estado !== 'cancelada' && cita.estado !== 'asistio') {
                                <button (click)="rescheduleCita(cita.idCita!)" class="btn btn-warning btn-small" style="margin-right: 5px; background-color: #f39c12; color: white; border: none;">Reprogramar</button>
                                <button (click)="cancelCita(cita.idCita!)" class="btn btn-danger btn-small">Cancelar</button>
                            }
                        </td>
                    </tr>
                } @empty {
                    <tr>
                        <td colspan="7" style="padding: 20px; text-align: center; color: var(--text-light);">No hay citas programadas.</td>
                    </tr>
                }
            </tbody>
        </table>
    </div>
</div>
